{% extends 'forum/base.html' %}

{% block title %}
–¢–µ–º–∞: {{ main_theme.header|truncatewords:10 }}
{% endblock %}

{% block content %}
<div class="page-header-container">
    <h1 class="header-white"><a href="{% url 'index' %}" class="header-button"><i class="fa-solid fa-arrow-left"></i> –ù–∞–∑–∞–¥</a></h1>
    <h1 class="header-white">–¢–µ–º–∞</h1>
</div>
{% if main_theme %}
    <div class="outer-theme-container">
        <div class="info-theme-container">
            <p class="theme-info">–ê–≤—Ç–æ—Ä: <a href="#" class="theme-author-button">{{main_theme.author_id}}</a></p>
            <p class="theme-info">–°–æ–∑–¥–∞–Ω–æ {{ main_theme.time_create }}</p>
        </div>
        <div class="main-theme-container">
            {% if main_theme.media %}
                <img src="{{ main_theme.media.url }}" data-fancybox alt="–ú–µ–¥–∏–∞-–≤–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–º—ã" class="theme-image">
                <div class="theme-text-container">
            {% else %}
                <div class="theme-text-container pictureless-theme">
            {% endif %}
                    <h2 class="header-blue">{{ main_theme.header }}</h2>
                    <p class="text-blue">{{ main_theme.text }}</p>
                </div>
        </div>
    </div>

    {% if posts_related %}
    {% for post in posts_related %}
    <div class="outer-post-container">
        <div class="info-post-container">
            <p class="post-info">–ê–≤—Ç–æ—Ä: {% if post.author_id %} <a href="#" class="post-author-button">{{post.author_id}}</a> {% else %} –ê–Ω–æ–Ω–∏–º {% endif %}</p>
            <p class="post-info">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ {{ post.create_time }}</p>
        </div>
        <div class="main-post-container">
            {% if post.post_picture %}
                <img src="{{ post.post_picture.url }}" data-fancybox alt="–ú–µ–¥–∏–∞-–≤–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–º—ã" class="post-image">
                <div class="post-text-container">
            {% else %}
                <div class="post-text-container pictureless-post">
            {% endif %}
                    <p class="text-blue">{{ post.text }}</p>
                </div>
        </div>
    </div>
    {% endfor %}

    {% else %}
    <div class="no-posts-alert-container">
        <p class="no-posts-alert-message">–¢–µ–º—É –µ—â—ë –Ω–∏–∫—Ç–æ –Ω–µ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª. –ù–µ—Ç –Ω–∏—á–µ–≥–æ –ø–ª–æ—Ö–æ–≥–æ –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å—Ç–∞—Ç—å –ø–µ—Ä–≤—ã–º üòâ</p>
    </div>
    {% endif %}
{% else %}
<div class="alert-danger alert mt-2">
    <p>–¢–∞–∫–æ–π —Ç–µ–º—ã –Ω–µ—Ç</p>
</div>
{% endif %}

<div class="page-header-container"><h1 class="header-white">–ù–∞–ø–∏—Å–∞—Ç—å –≤ —Ç–µ–º—É</h1></div>
{% if request.user.is_authenticated %}
    <form class="form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div>{{ form.non_field_errors }}</div>
        {% for field in form %}
            <p class="form-field"><label for="{{ field.id_for_label }}" class="text-blue">{{field.label}}: </label>{{ field }}</p>
            <div class="">{{ field.errors }}</div>
        {% endfor %}
        <button type="submit" class="g-recaptcha form-submit-btn"
        data-sitekey="{{ captcha_site_key }}"
        data-callback='onSubmit'
        data-action='submit'>–ó–∞–ø–æ—Å—Ç–∏—Ç—å</button>
    </form>
{% else %}
    <p class="text-white">–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º—É –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª–∑–æ–≤–∞—Ç–µ–ª–∏</p>  <!-- TODO: Unwanted behaviour -->
{% endif %}
{% endblock %}